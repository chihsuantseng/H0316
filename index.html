<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>醫療耗材訂購</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
    <h2>醫療耗材訂購</h2>
    <label for="product">選擇商品：</label>
    <select id="product">
        <option value="手套">手套</option>
        <option value="口罩">口罩</option>
        <option value="針筒">針筒</option>
    </select>
    <br><br>
    <label for="quantity">數量：</label>
    <input type="number" id="quantity" min="1" max="100" value="1">
    <br><br>
    <button onclick="submitOrder()">提交訂單</button>

    <script>
        // 1️⃣ 初始化 LIFF
        function initializeLiff() {
            liff.init({ liffId: "HHH" })
                .then(() => {
                    console.log("LIFF 初始化成功");
                    if (!liff.isLoggedIn()) {
                        liff.login();
                    }
                })
                .catch(err => console.error("LIFF 初始化失敗", err));
        }

        // 2️⃣ 提交訂單
        function submitOrder() {
            const product = document.getElementById("product").value;
            const quantity = document.getElementById("quantity").value;

            if (!product || quantity <= 0) {
                alert("請選擇商品並輸入正確數量！");
                return;
            }

            // 3️⃣ 發送訊息到 LINE 聊天視窗
            liff.sendMessages([
                { type: "text", text: `我要訂購 ${product} ${quantity} 件` }
            ]).then(() => {
                alert("✅ 訂購成功！");
                liff.closeWindow(); // 關閉 LIFF
            }).catch(err => console.error("發送訊息失敗", err));
        }

        // 4️⃣ 網頁載入時初始化 LIFF
        window.onload = initializeLiff;
    </script>
</body>
</html>
